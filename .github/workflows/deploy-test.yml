name: Deploy to Test PyPi

on:
  pull_request:
    types:
      - labeled
  workflow_dispatch:

env:
  HATCH_VERSION: "v1.7.0" # keep in sync with deploy.yml

jobs:
  deploy-test:
    if: ${{ github.event.label.name == 'test-deploy' }}`
    uses: ./.github/workflows/deploy.yml
    with:
      deployment_env: "test"
      api_url: "https://api.dev.cloud.dpst.dev/api/v1"
    secrets:
      TEST_API_KEY: ${{ secrets.API_KEY }}
